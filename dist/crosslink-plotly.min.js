!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((r["crosslink-plotly"]=r["crosslink-plotly"]||{},r["crosslink-plotly"].js={}))}(this,function(r){"use strict";function f(r){return null!=r&&"object"==typeof r&&!0===r["@@functional/placeholder"]}function o(n){return function r(t){return 0===arguments.length||f(t)?r:n.apply(this,arguments)}}function t(e){return function r(t,n){switch(arguments.length){case 0:return r;case 1:return f(t)?r:o(function(r){return e(t,r)});default:return f(t)&&f(n)?r:f(t)?o(function(r){return e(r,n)}):f(n)?o(function(r){return e(t,r)}):e(t,n)}}}function l(r,l){switch(r){case 0:return function(){return l.apply(this,arguments)};case 1:return function(r){return l.apply(this,arguments)};case 2:return function(r,t){return l.apply(this,arguments)};case 3:return function(r,t,n){return l.apply(this,arguments)};case 4:return function(r,t,n,e){return l.apply(this,arguments)};case 5:return function(r,t,n,e,o){return l.apply(this,arguments)};case 6:return function(r,t,n,e,o,i){return l.apply(this,arguments)};case 7:return function(r,t,n,e,o,i,u){return l.apply(this,arguments)};case 8:return function(r,t,n,e,o,i,u,a){return l.apply(this,arguments)};case 9:return function(r,t,n,e,o,i,u,a,c){return l.apply(this,arguments)};case 10:return function(r,t,n,e,o,i,u,a,c,f){return l.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function s(u,a,c){return function(){for(var r,t=arguments,n=[],e=0,o=u,i=0;i<a.length||e<arguments.length;)i<a.length&&(!f(a[i])||t.length<=e)?r=a[i]:(r=t[e],e+=1),f(n[i]=r)||--o,i+=1;return o<=0?c.apply(this,n):l(o,s(u,n,c))}}var i=t(function(r,t){return 1===r?o(t):l(r,s(r,[],t))});var u=Array.isArray||function(r){return null!=r&&0<=r.length&&"[object Array]"===Object.prototype.toString.call(r)};function n(e,o,i){return function(){if(0===arguments.length)return i();var r=Array.prototype.slice.call(arguments,0),t=r.pop();if(!u(t)){for(var n=0;n<e.length;){if("function"==typeof t[e[n]])return t[e[n]].apply(t,r);n+=1}if("function"==typeof t["@@transducer/step"])return o.apply(null,r)(t)}return i.apply(this,arguments)}}var e={init:function(){return this.xf["@@transducer/init"]()},result:function(r){return this.xf["@@transducer/result"](r)}};function a(r,t){for(var n=0,e=t.length,o=Array(e);n<e;)o[n]=r(t[n]),n+=1;return o}function M(r){return"[object String]"===Object.prototype.toString.call(r)}var U=o(function(r){return!!u(r)||!!r&&"object"==typeof r&&!M(r)&&(1===r.nodeType?!!r.length:0===r.length||0<r.length&&r.hasOwnProperty(0)&&r.hasOwnProperty(r.length-1))}),q=function(){function r(r){this.f=r}return r.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},r.prototype["@@transducer/result"]=function(r){return r},r.prototype["@@transducer/step"]=function(r,t){return this.f(r,t)},r}();function z(r){return new q(r)}var K=t(function(r,t){return l(r.length,function(){return r.apply(t,arguments)})});function c(r,t,n){for(var e=n.next();!e.done;){if((t=r["@@transducer/step"](t,e.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}e=n.next()}return r["@@transducer/result"](t)}function p(r,t,n,e){return r["@@transducer/result"](n[e](K(r["@@transducer/step"],r),t))}var d="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function L(r,t,n){if("function"==typeof r&&(r=z(r)),U(n)){for(var e=r,o=t,i=n,u=0,a=i.length;u<a;){if((o=e["@@transducer/step"](o,i[u]))&&o["@@transducer/reduced"]){o=o["@@transducer/value"];break}u+=1}return e["@@transducer/result"](o)}if("function"==typeof n["fantasy-land/reduce"])return p(r,t,n,"fantasy-land/reduce");if(null!=n[d])return c(r,t,n[d]());if("function"==typeof n.next)return c(r,t,n);if("function"==typeof n.reduce)return p(r,t,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var R=function(){function r(r,t){this.xf=t,this.f=r}return r.prototype["@@transducer/init"]=e.init,r.prototype["@@transducer/result"]=e.result,r.prototype["@@transducer/step"]=function(r,t){return this.xf["@@transducer/step"](r,this.f(t))},r}(),h=t(function(r,t){return new R(r,t)});function y(r,t){return Object.prototype.hasOwnProperty.call(t,r)}var v=Object.prototype.toString,B=!{toString:null}.propertyIsEnumerable("toString"),g=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],m=function(){return arguments.propertyIsEnumerable("length")}(),b=o("function"!=typeof Object.keys||m?function(r){if(Object(r)!==r)return[];var t,n,e=[],o=m&&function(){return"[object Arguments]"===v.call(arguments)?function(r){return"[object Arguments]"===v.call(r)}:function(r){return y("callee",r)}}(r);for(t in r)!y(t,r)||o&&"length"===t||(e[e.length]=t);if(B)for(n=g.length-1;0<=n;)y(t=g[n],r)&&!function(r,t){for(var n=0;n<r.length;){if(r[n]===t)return!0;n+=1}return!1}(e,t)&&(e[e.length]=t),--n;return e}:function(r){return Object(r)!==r?[]:Object.keys(r)}),W=t(n(["fantasy-land/map","map"],h,function(n,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return i(e.length,function(){return n.call(this,e.apply(this,arguments))});case"[object Object]":return L(function(r,t){return r[t]=n(e[t]),r},{},b(e));default:return a(n,e)}})),X=o(function(r){for(var t=b(r),n=t.length,e=[],o=0;o<n;)e[o]=r[t[o]],o+=1;return e});var $=o(function(r){return null===r?"Null":void 0===r?"Undefined":Object.prototype.toString.call(r).slice(8,-1)});function D(o,i,u,a){function r(r){for(var t,n=i.length,e=0;e<n;){if(o===i[e])return u[e];e+=1}for(t in i[e+1]=o,u[e+1]=r,o)r[t]=a?D(o[t],i,u,!0):o[t];return r}switch($(o)){case"Object":return r({});case"Array":return r([]);case"Date":return new Date(o.valueOf());case"RegExp":return new RegExp(o.source,(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":""));default:return o}}var A=o(function(r){return null!=r&&"function"==typeof r.clone?r.clone():D(r,[],[],!0)});Date.prototype.toISOString;function w(r){return"[object Number]"===Object.prototype.toString.call(r)}function O(r){return"[object Object]"===H.call(r)&&(null===(r=Object.getPrototypeOf(r))||r===Object.getPrototypeOf({}))}var x=t(function(r,t){if(!w(r)||!w(t))throw new TypeError("Both arguments to range must be numbers");for(var n=[],e=r;e<t;)n.push(e),e+=1;return n}),G=o(function(r){var t,n=[];for(t in r)y(t,r)&&(n[n.length]=[t,r[t]]);return n}),H=(String.prototype.trim,Object.prototype.toString);function _(r){var t="",n=0;"_fullData"===r[n]&&(n+=2),"_fullInput"===r[n]&&n++,"_fullLayout"===r[n]&&n++;for(var e=n;e<r.length;e++)"number"==typeof r[e]||Array.isArray(r[e])?t+="["+(Array.isArray(r[e])?r[e][0]:r[e])+"]":t+=(n<e?".":"")+r[e];return t}function k(i,u,a,c){var f=c.walkArrays,l=c.walkArraysMatchingKeys;Object.keys(i).forEach(function(r){var t,n,e,o;!u(r,i,a.get(i,r))&&(t=i[r],O(t)||(n=r,e=f,o=l,Array.isArray(t)&&(e||o&&o.includes(n))))&&k(t,u,a.set(i,r),c)})}function E(r,t,n){if(void 0===n&&(n={}),!O(r)&&!Array.isArray(r))throw new Error("The input must be an object.");k(r,t,function e(o,r){return void 0===o&&(o="array"),{_path:r||("array"===o?[]:""),set:function(r,t){var n;switch(o){case"array":n=this._path.concat([t]);break;case"nestedProperty":n=0===this._path.length?t:Array.isArray(r)?this._path+"["+t+"]":this._path+"."+t;break;default:throw new Error("unrecognized pathType "+o)}return e(o,n)},get:function(r,t){return("array"===o?this:this.set(r,t))._path}}}(n.pathType),n)}var tr="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(r){function R(r){return r}function k(r,t){for(var n=0,e=t.length,o=new Array(e);n<e;++n)o[n]=r[t[n]];return o}function t(i){function r(r,t,n,e){for(;n<e;){var o=n+e>>>1;t<i(r[o])?e=o:n=1+o}return n}return(r.right=r).left=function(r,t,n,e){for(;n<e;){var o=n+e>>>1;i(r[o])<t?n=1+o:e=o}return n},r}function B(a){function r(r,t,n){for(var e=n-t,o=1+(e>>>1);0<--o;)i(r,o,e,t);return r}function i(r,t,n,e){for(var o,i=r[--e+t],u=a(i);(o=t<<1)<=n&&(o<n&&a(r[e+o])>a(r[e+o+1])&&o++,!(u<=a(r[e+o])));)r[e+t]=r[e+o],t=o;r[e+t]=i}return r.sort=function(r,t,n){for(var e,o=n-t;0<--o;)e=r[t],r[t]=r[t+o],r[t+o]=e,i(r,1,o,t);return r},r}function W(c){var f=B(c);return function(r,t,n,e){for(var o,i,u=new Array(e=Math.min(n-t,e)),a=0;a<e;++a)u[a]=r[t++];if(f(u,0,e),t<n)for(o=c(u[0]);c(i=r[t])>o&&(u[0]=i,o=c(f(u,0,e)[0])),++t<n;);return u}}function n(a){return function(r,t,n){for(var e=t+1;e<n;++e){for(var o=e,i=r[e],u=a(i);t<o&&a(r[o-1])>u;--o)r[o]=r[o-1];r[o]=i}return r}}function E(j){var e=n(j);function S(r,t,n){return(n-t<i?e:o)(r,t,n)}function o(r,t,n){var e,o=(n-t)/6|0,i=t+o,u=n-1-o,a=t+n-1>>1,c=a-o,o=a+o,f=r[i],l=j(f),s=r[c],p=j(s),d=r[a],h=j(d),y=r[o],v=j(y),g=r[u],m=j(g),l=(p<l&&(O=f,f=s,s=O,O=l,l=p,p=O),m<v&&(O=y,y=g,g=O,O=v,v=m,m=O),h<l&&(O=f,f=d,d=O,O=l,l=h,h=O),h<p&&(O=s,s=d,d=O,O=p,p=h,h=O),v<l&&(O=f,f=y,y=O,O=l,l=v,v=O),v<h&&(O=d,d=y,y=O,O=h,h=v,v=O),m<p&&(O=s,s=g,g=O,O=p,p=m,m=O),h<p&&(O=s,s=d,d=O,O=p,p=h,h=O),m<v&&(O=y,y=g,g=O,O=v,v=m,m=O),s),b=p,h=y,D=v,A=(r[i]=f,r[c]=r[t],r[a]=d,r[o]=r[n-1],r[u]=g,t+1),w=n-2,O=b<=D&&D<=b;if(O)for(var x=A;x<=w;++x){var _=r[x];if((k=j(_))<b)x!==A&&(r[x]=r[A],r[A]=_),++A;else if(b<k)for(;;){if(!(b<(E=j(r[w])))){if(E<b){r[x]=r[A],r[A++]=r[w],r[w--]=_;break}r[x]=r[w],r[w--]=_;break}w--}}else for(x=A;x<=w;x++){_=r[x];if((k=j(_))<b)x!==A&&(r[x]=r[A],r[A]=_),++A;else if(D<k)for(;;){if(!(D<(E=j(r[w])))){E<b?(r[x]=r[A],r[A++]=r[w]):r[x]=r[w],r[w--]=_;break}if(--w<x)break}}if(r[t]=r[A-1],r[A-1]=l,r[n-1]=r[w+1],r[w+1]=h,S(r,t,A-1),S(r,w+2,n),O)return r;if(A<i&&u<w){for(;(e=j(r[A]))<=b&&b<=e;)++A;for(;(E=j(r[w]))<=D&&D<=E;)--w;for(x=A;x<=w;x++){var k,E,_=r[x];if((k=j(_))<=b&&b<=k)x!==A&&(r[x]=r[A],r[A]=_),A++;else if(k<=D&&D<=k)for(;;){if(!((E=j(r[w]))<=D&&D<=E)){E<b?(r[x]=r[A],r[A++]=r[w]):r[x]=r[w],r[w--]=_;break}if(--w<x)break}}}return S(r,A,w+1)}return S}function e(r){for(var t=new Array(r),n=-1;++n<r;)t[n]=0;return t}function j(r){return[0,r.length]}function X(){return null}function $(){return 0}function G(r){return r+1}function H(r){return r-1}function J(n){return function(r,t){return r+ +n(t)}}function Q(n){return function(r,t){return r-n(t)}}function o(){var r={add:t,remove:function(){for(var t=V(q,q),n=[],r=0,e=0;r<q;++r)z[r]?t[r]=e++:n.push(r);K.forEach(function(r){r(0,[],n)}),L.forEach(function(r){r(t)});for(var o,r=0,e=0;r<q;++r)(o=z[r])&&(r!==e&&(z[e]=o,U[e]=U[r]),++e);U.length=e;for(;e<q;)z[--q]=0},dimension:function(l){var s,p,d,h,y,c={filter:function(r){return null==r?a():(Array.isArray(r)?u:"function"==typeof r?f:o)(r)},filterExact:o,filterRange:u,filterFunction:f,filterAll:a,top:function(r){var t,n=[],e=D;for(;--e>=b&&0<r;)z[t=p[e]]||(n.push(U[t]),--r);return n},bottom:function(r){var t,n=[],e=b;for(;e<D&&0<r;)z[t=p[e]]||(n.push(U[t]),--r),e++;return n},group:w,groupAll:function(){var r=w(X),t=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return t()[0].value},r},dispose:r,remove:r},v=~O&-~O,F=~v,g=E(function(r){return d[r]}),m=j,T=[],M=[],b=0,D=0;_.unshift(t),_.push(n),L.push(e),O|=v,(32<=x?!v:O&-(1<<x))&&(z=rr(z,x<<=1));function t(r,t,n){d=r.map(l),h=g(function(r){for(var t=V(r,r),n=-1;++n<r;)t[n]=n;return t}(n),0,n),d=k(d,h);var e,r=m(d),o=r[0],i=r[1];if(y)for(e=0;e<n;++e)y(d[e],e)||(z[h[e]+t]|=v);else{for(e=0;e<o;++e)z[h[e]+t]|=v;for(e=i;e<n;++e)z[h[e]+t]|=v}if(t){var u=s,a=p,c=0,f=0;for(s=new Array(q),p=V(q,q),e=0;c<t&&f<n;++e)u[c]<d[f]?(s[e]=u[c],p[e]=a[c++]):(s[e]=d[f],p[e]=h[f++]+t);for(;c<t;++c,++e)s[e]=u[c],p[e]=a[c];for(;f<n;++f,++e)s[e]=d[f],p[e]=h[f]+t;r=m(s),b=r[0],D=r[1]}else s=d,p=h,b=o,D=i}function n(r,t,n){T.forEach(function(r){r(d,h,t,n)}),d=h=null}function e(r){for(var t,n=0,e=0;n<q;++n)z[t=p[n]]&&(n!==e&&(s[e]=s[n]),p[e]=r[t],++e);for(s.length=e;e<q;)p[e++]=0;var o=m(s);b=o[0],D=o[1]}function i(r){var n=r[0],e=r[1];if(y)y=null,A(function(r,t){return n<=t&&t<e}),b=n,D=e;else{var t,o,i,u=[],a=[];if(n<b)for(t=n,o=Math.min(b,e);t<o;++t)z[i=p[t]]^=v,u.push(i);else if(b<n)for(t=b,o=Math.min(n,D);t<o;++t)z[i=p[t]]^=v,a.push(i);if(D<e)for(t=Math.max(n,D),o=e;t<o;++t)z[i=p[t]]^=v,u.push(i);else if(e<D)for(t=Math.max(b,e),o=D;t<o;++t)z[i=p[t]]^=v,a.push(i);b=n,D=e,K.forEach(function(r){r(v,u,a)})}return c}function o(r){return i((n=S,e=r,(m=function(r){var t=r.length;return[n.left(r,e,0,t),n.right(r,e,0,t)]})(s)));var n,e}function u(r){return i((n=S,e=r[0],o=r[1],(m=function(r){var t=r.length;return[n.left(r,e,0,t),n.left(r,o,0,t)]})(s)));var n,e,o}function a(){return i((m=j)(s))}function f(r){return m=j,A(y=r),b=0,D=q,c}function A(r){for(var t,n,e=[],o=[],i=0;i<q;++i)!(z[t=p[i]]&v)^!!(n=r(s[i],i))&&(n?(z[t]&=F,e):(z[t]|=v,o)).push(t);K.forEach(function(r){r(v,e,o)})}function w(m){var e={top:function(r){r=n(u(),0,b.length,r);return o.sort(r,0,r.length)},all:u,reduce:c,reduceCount:r,reduceSum:function(r){return c(J(r),Q(r),$)},order:f,orderNatural:function(){return f(R)},size:function(){return _},dispose:l,remove:l};M.push(e);var b,D,n,o,A,a,w,O=8,x=Y(O),_=0,k=X,E=X,j=!0,S=m===X;function t(r,t,n,e){var o,i,u,a,c,f,l=b,s=V(_,x),p=A,d=w,h=_,y=0,v=0;for(j&&(p=d=X),b=new Array(_),_=0,D=1<h?Z(D,q):V(q,x),h&&(u=(i=l[0]).key);v<e&&!((a=m(r[v]))>=a);)++v;for(;v<e;){for(i&&u<=a?(c=i,f=u,s[y]=_,(i=l[++y])&&(u=i.key)):(c={key:a,value:d()},f=a),b[_]=c;!(f<a||(D[o=t[v]+n]=_,z[o]&F||(c.value=p(c.value,U[o])),++v>=e));)a=m(r[v]);g()}for(;y<h;)b[s[y]=_]=l[y++],g();if(y<_)for(y=0;y<n;++y)D[y]=s[D[y]];function g(){++_===x&&(s=rr(s,O<<=1),D=rr(D,O),x=Y(O))}o=K.indexOf(k),1<_?(k=N,E=I):(!_&&S&&(_=1,b=[{key:null,value:d()}]),E=1===_?(k=C,P):k=X,D=null),K[o]=k}function i(){if(1<_){for(var r=_,t=b,n=V(r,r),e=0,o=0;e<q;++e)z[e]&&(n[D[o]=D[e]]=1,++o);for(b=[],e=_=0;e<r;++e)n[e]&&(n[e]=_++,b.push(t[e]));if(1<_)for(e=0;e<o;++e)D[e]=n[D[e]];else D=null;K[K.indexOf(k)]=1<_?(E=I,k=N):1===_?(E=P,k=C):E=k=X}else if(1===_&&!S){for(e=0;e<q;++e)if(z[e])return;b=[],_=0,K[K.indexOf(k)]=k=E=X}}function N(r,t,n){if(r!==v&&!j){for(var e,o,i=0,u=t.length;i<u;++i)z[e=t[i]]&F||((o=b[D[e]]).value=A(o.value,U[e]));for(i=0,u=n.length;i<u;++i)(z[e=n[i]]&F)===r&&((o=b[D[e]]).value=a(o.value,U[e]))}}function C(r,t,n){if(r!==v&&!j){for(var e,o=b[0],i=0,u=t.length;i<u;++i)z[e=t[i]]&F||(o.value=A(o.value,U[e]));for(i=0,u=n.length;i<u;++i)(z[e=n[i]]&F)===r&&(o.value=a(o.value,U[e]))}}function I(){for(var r,t=0;t<_;++t)b[t].value=w();for(t=0;t<q;++t)z[t]&F||((r=b[D[t]]).value=A(r.value,U[t]))}function P(){var r,t=b[0];for(t.value=w(),r=0;r<q;++r)z[r]&F||(t.value=A(t.value,U[r]))}function u(){return j&&(E(),j=!1),b}function c(r,t,n){return A=r,a=t,w=n,j=!0,e}function r(){return c(G,H,$)}function f(t){function r(r){return t(r.value)}return n=W(r),o=B(r),e}function l(){var r=K.indexOf(k);return 0<=r&&K.splice(r,1),0<=(r=T.indexOf(t))&&T.splice(r,1),0<=(r=L.indexOf(i))&&L.splice(r,1),e}return arguments.length<1&&(m=R),K.push(k),T.push(t),L.push(i),t(s,p,0,q),r().orderNatural()}function r(){M.forEach(function(r){r.dispose()});var r=_.indexOf(t);return 0<=r&&_.splice(r,1),0<=(r=_.indexOf(n))&&_.splice(r,1),0<=(r=L.indexOf(e))&&L.splice(r,1),O&=F,a()}return t(U,0,q),n(0,0,q),c},groupAll:function(){var u,a,c,e,o={reduce:i,reduceCount:r,reduceSum:function(r){return i(J(r),Q(r),$)},value:function(){f&&(function(){var r;for(u=e(),r=0;r<q;++r)z[r]||(u=a(u,U[r]))}(),f=!1);return u},dispose:l,remove:l},f=!0;function t(r,t){var n;if(!f)for(n=t;n<q;++n)z[n]||(u=a(u,U[n]))}function n(r,t,n){var e,o,i;if(!f){for(e=0,i=t.length;e<i;++e)z[o=t[e]]||(u=a(u,U[o]));for(e=0,i=n.length;e<i;++e)z[o=n[e]]===r&&(u=c(u,U[o]))}}function i(r,t,n){return a=r,c=t,e=n,f=!0,o}function r(){return i(G,H,$)}function l(){var r=K.indexOf(n);return 0<=r&&K.splice(r),0<=(r=_.indexOf(t))&&_.splice(r),o}return K.push(n),_.push(t),t(0,0),r()},size:function(){return q}},U=[],q=0,O=0,x=8,z=u(0),K=[],_=[],L=[];function t(t){var n=q,e=t.length;return e&&(U=U.concat(t),z=Z(z,q+=e),_.forEach(function(r){r(t,n,e)})),r}return arguments.length?t(arguments[0]):r}function V(r,t){return(t<257?u:t<65537?a:c)(r)}function Y(r){return 8===r?256:16===r?65536:4294967296}var S,i,u,a,c,Z,rr;r=r||tr,o.version="1.3.12",o.permute=k,(S=o.bisect=t(R)).by=t,(o.heap=B(R)).by=B,(o.heapselect=W(R)).by=W,(o.insertionsort=n(R)).by=n,(o.quicksort=E(R)).by=E,i=32,c=a=u=e,Z=function(r,t){var n=r.length;for(;n<t;)r[n++]=0;return r},rr=function(r,t){if(32<t)throw new Error("invalid array width!");return r},"undefined"!=typeof Uint8Array&&(u=function(r){return new Uint8Array(r)},a=function(r){return new Uint16Array(r)},c=function(r){return new Uint32Array(r)},Z=function(r,t){return r.length>=t?r:((t=new r.constructor(t)).set(r),t)},rr=function(r,t){var n;switch(t){case 16:n=a(r.length);break;case 32:n=c(r.length);break;default:throw new Error("invalid array width!")}return n.set(r),n}),r.crossfilter=o})((h={exports:{}},h.exports));function j(r,t,n){var e=t._crossfilter,o=e.plotDimensions.find(function(r){return r.gd===t}),n=function(n,r,t){var e=r.constrained&&"pie"===n._fullData[0].type?null:t;if("pie"===n._fullData[0].type)return e?e.points:[];"histogram"===n._fullData[0].type&&(e={points:[]},t)&&!Array.isArray(t)&&t.points.forEach(function(t){(t.pointNumbers||n.calcdata[0][t.pointNumber].pts).forEach(function(r){e.points.push({pointNumber:r,curveNumber:t.curveNumber,data:t.data,fullData:t.fullData})})});return e?e.points.filter(function(r){return r.curveNumber<n._cfData.originalData.length&&r.data.uid===n.data[r.curveNumber].uid}):[]}(t,o,n),i=(F(e),rr(t,n));o.constrained=0<n.length,o.constrained||t.querySelectorAll(".select-outline").forEach(function(r){return r.parentNode.removeChild(r)}),o.cfDimension.filterFunction(o.constrained?function(r){return i[r]}:function(){return!0}),r.restyle(t,"selectedpoints",null),P(r,e,I(document).filter(function(r){return r.includedInCrossfilter}))}var h=h.exports.crossfilter,J=function(r){var t=typeof r;if("string"==t){var n=r;if(0===(r=+r)&&function(r){for(var t,n=r.length,e=0;e<n;e++)if(((t=r.charCodeAt(e))<9||13<t)&&32!==t&&133!==t&&160!==t&&5760!==t&&6158!==t&&(t<8192||8205<t)&&8232!==t&&8233!==t&&8239!==t&&8287!==t&&8288!==t&&12288!==t&&65279!==t)return!1;return!0}(n))return!1}else if("number"!=t)return!1;return r-r<1},Q=h,V=["bar","box","choropleth","histogram","pie","scatter","scatter3d","scattergeo","scattermapbox","table"],S=.1,Y=.01,Z=/[^:]+(?=[^:]*$)/,N=function(r){return"src"===r.slice(-"src".length)},C=function(r){return r.slice(0,-"src".length)},I=function(r){return[].slice.call(r.querySelectorAll(".js-plotly-plot"))},rr=function(r,t){for(var n={},e=0;e<t.length;e++){var o=t[e],i=o.fullData&&o.fullData.transforms,i=i?i.filter(function(r){return r._indexToPoints}):[];if(i.length)i[i.length-1]._indexToPoints[o.pointNumber].forEach(function(r){n[r]={pointNumber:r}});else if("pie"===r._fullData[0].type)for(var u=0;u<r.data[0].labels.length;u++)r.data[0].labels[u]===o.label&&(n[u]={pointNumber:u});else n[o.pointNumber]=o}return n},nr=function(r,t,n){for(var e=0,o=r;e<t.length;e++){var i=t[e],u=void 0!==o[i];e===t.length-1?o[i]=n:u||(o[i]={}),o=o[i]}},er=function(r){return E(r,function(r,t,n){"src"===r.slice(-"src".length)&&"header"!==n[0]&&(t[C(r)]=[])},{walkArraysMatchingKeys:["transforms"]})},P=function(f,t,r){var l=t.plotDimensions.concat(t.formDimensions).some(function(r){return r.constrained}),n=l?t.recordDimension.top(1/0).sort(function(r,t){return r.index-t.index}):[];r.filter(function(r){return r.includedInCrossfilter}).forEach(function(c){var r=c._cfData.originalData.map(A);r.forEach(er),[].concat.apply([],X(t.fieldSources)).filter(function(r){return r.gd===c}).forEach(function(e){var o=n.map(function(r){return r[e.gridColumnName]});r.forEach(function(r,t){var n;t===e.traceIndex&&(nr(r,e.pathArray,o),n=c._fullData[t].marker||{},n=!Array.isArray(n.color)||!J(n.color[0]),"pie"!==r.type)&&c._fullData[t].marker&&n&&(r.marker=r.marker||{},r.marker.color=c._fullData[t].marker.color)})}),f.deleteTraces(c,x(c._cfData.originalData.length,c.data.length)),l&&c._fullData.length===c._cfData.originalData.length&&f.addTraces(c,r),r.forEach(function(r,t){var n=f,e=c,o=l,i=t,u=n.d3.select(e);switch(r.type){case"choropleth":T(n,e,i,o);var a=e._cfData.originalOpacity[i];return u.selectAll(".trace path").style("opacity",1),u.selectAll(".trace").filter(function(r,t){return t===i}).style("opacity",o?0:a),u.selectAll(".colorbar .cbaxis").style("opacity",0),void window.setTimeout(function(){u.selectAll(".colorbar .cbaxis").style("opacity",function(r,t){return t===i&&o?0:null})});case"scatter":case"box":T(n,e,i,o);a=e._cfData.originalOpacity[i];return void u.selectAll(".trace").filter(function(r,t){return t===i}).style("opacity",o?S:a);case"bar":return T(n,e,i,o),void("stack"===e.layout.barmode?n.restyle(e,"visible",!o,x(0,e._cfData.originalData.length)):(a=e._cfData.originalOpacity[i],u.selectAll(".trace").filter(function(r,t){return t===i}).style("opacity",o?S:a)));case"histogram":a=e._cfData.originalOpacity[i];return void u.selectAll(".trace").filter(function(r,t){return t===i}).style("opacity",o?0:a);case"table":return void u.select(".table").style("opacity",o?0:null);case"pie":return u.select(".trace").style("opacity",o?0:null),void u.selectAll(".hovertext").remove();case"scattermapbox":return void n.restyle(e,"marker.opacity",o?Y:1,[i]);case"scatter3d":return void n.restyle(e,"marker.opacity",o?S:e._cfData.originalFullData[i].marker.opacity,[i]);default:n.d3.select(e).select(".trace").style("opacity",o?S:null)}})})},F=function(r){return r.plotDimensions.concat(r.formDimensions).forEach(function(r){r.constrained=!1,r.cfDimension&&r.cfDimension.filter(null)})};function T(r,t,n,e){e=e?"none":t._cfData.originalFullData[n].hoverinfo;e&&t._fullData[n].hoverinfo!==e&&-1===["scattermapbox","scattergeo","scatter3d"].indexOf(t._fullData[0].type)&&r.restyle(t,"hoverinfo",e,[n])}r.cfEnabled=function(r,t){return r&&(r=t.data,t=r.every(function(r){return-1!==V.indexOf(r.type)}),n={},r.forEach(function(t){return Object.keys(t).filter(N).forEach(function(r){r=t[C(r)].length;n[r]=!0})}),e=Object.keys(n).length<2,o=!1,r.some(function(r){return E(r,function(r){N(r)&&(o=!0)},{walkArraysMatchingKeys:["transforms"]})}),t)&&o&&e;var n,e,o},r.cfLayoutOverrides={dragmode:"select",showlegend:!1},r.resetCrossfilter=function(r){var t=I(document),n=t[0]._crossfilter;F(n),P(r,n,[].concat(t).filter(function(r){return r.includedInCrossfilter}))},r.specFilter=function(r,t){var n=I(document),e=t.gridColumn,o=t.isNaN?t.value:Number(t.value),t=t.operator,i=n[0]._crossfilter,u=i.formDimensions[0],a=(u.constrained=!0,u.cfDimension&&(u.cfDimension.filter(null),u.cfDimension.dispose(),u.cfDimension=null,u.constrained=!1),u.cfDimension=i.cf.dimension(function(r){return r[e]}),{">":function(r){return o<r},"<":function(r){return r<o},"==":function(r){return r===o}});u.cfDimension.filterFunction(a[t]),u.constrained=!0,P(r,i,[].concat(n).filter(function(r){return r.includedInCrossfilter}))},r.cfPlotSetup=function(t,r,n,e,o){var i=(r=r).length?r[0]._crossfilter:{fieldSources:{},cf:null,grid:{}},u=(e._crossfilter=i,o.data.forEach(function(r,t){return c=e,l=t,E(f=r,function(r,e,o){var t,i,u,a,n=c._crossfilter;"table"===f.type&&"header"===o[0]||N(r)&&(t=e[r].match(Z)[0],u=C(i=r),a=[],"table"===f.type&&"cells"===o[0]?t.replace(/\*/g,"").split(",").forEach(function(r,t){var n=o.concat([u,t]);a.push({gd:c,srcFieldName:i,traceIndex:l,data:e[u][t],pathArray:n,fieldPath:_(n),constrained:!1,gridColumnName:r})}):a.push({gd:c,srcFieldName:i,traceIndex:l,data:e[u],pathArray:o.concat([u]),fieldPath:_(o.concat([u])),constrained:!1,gridColumnName:t}),a.forEach(function(r){n.fieldSources[r.gridColumnName]=(n.fieldSources[r.gridColumnName]||[]).concat(r)}))},{walkArraysMatchingKeys:["transforms"]});var c,f,l}),Object.keys(i.fieldSources).forEach(function(r){var t=i.fieldSources[r];i.grid[r]=t[0].data}),i.cf=Q(),n.then(function(r){"pie"===r._fullData[0].type?r.on("plotly_click",j.bind(0,t,r)):r.on("plotly_selected",j.bind(0,t,r)),r.includedInCrossfilter=!0,i.plotDimensions&&i.plotDimensions.length&&i.plotDimensions.forEach(function(r){return r.cfDimension.dispose()}),i.plotDimensions=I(document).filter(function(r){return r.includedInCrossfilter}).map(function(r){return{gd:r,constrained:!1,cfDimension:i.cf.dimension(function(r){return r.index})}}),i.formDimensions=[{gd:void 0,constrained:!1,cfDimension:null}],e._cfData={originalData:e.data.map(A),originalFullData:e._fullData.map(A),originalOpacity:W(function(r){return r.style.opacity})(e.querySelectorAll(".trace"))}}),i.recordDimension=i.cf.dimension(function(r){return r}),G(i.grid));u.length&&(r=u[0][1].map(function(r,t){for(var n={},e=0;e<u.length;e++)n.index=t,n[u[e][0]]=u[e][1][t];return n}),i.cf.add(r))},Object.defineProperty(r,"__esModule",{value:!0})});
