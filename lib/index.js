"use strict";function _isPlaceholder(r){return null!=r&&"object"==typeof r&&!0===r["@@functional/placeholder"]}function _curry1(e){return function r(t){return 0===arguments.length||_isPlaceholder(t)?r:e.apply(this,arguments)}}Object.defineProperty(exports,"__esModule",{value:!0});var always=_curry1(function(r){return function(){return r}}),F=always(!1),T=always(!0);function _curry2(n){return function r(t,e){switch(arguments.length){case 0:return r;case 1:return _isPlaceholder(t)?r:_curry1(function(r){return n(t,r)});default:return _isPlaceholder(t)&&_isPlaceholder(e)?r:_isPlaceholder(t)?_curry1(function(r){return n(r,e)}):_isPlaceholder(e)?_curry1(function(r){return n(t,r)}):n(t,e)}}}var add=_curry2(function(r,t){return Number(r)+Number(t)});function _concat(r,t){for(var e=(r=r||[]).length,n=(t=t||[]).length,u=[],i=0;i<e;)u[u.length]=r[i],i+=1;for(i=0;i<n;)u[u.length]=t[i],i+=1;return u}function _arity(r,s){switch(r){case 0:return function(){return s.apply(this,arguments)};case 1:return function(r){return s.apply(this,arguments)};case 2:return function(r,t){return s.apply(this,arguments)};case 3:return function(r,t,e){return s.apply(this,arguments)};case 4:return function(r,t,e,n){return s.apply(this,arguments)};case 5:return function(r,t,e,n,u){return s.apply(this,arguments)};case 6:return function(r,t,e,n,u,i){return s.apply(this,arguments)};case 7:return function(r,t,e,n,u,i,o){return s.apply(this,arguments)};case 8:return function(r,t,e,n,u,i,o,a){return s.apply(this,arguments)};case 9:return function(r,t,e,n,u,i,o,a,c){return s.apply(this,arguments)};case 10:return function(r,t,e,n,u,i,o,a,c,l){return s.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function _curryN(o,a,c){return function(){for(var r,t=arguments,e=[],n=0,u=o,i=0;i<a.length||n<arguments.length;)i<a.length&&(!_isPlaceholder(a[i])||t.length<=n)?r=a[i]:(r=t[n],n+=1),_isPlaceholder(e[i]=r)||--u,i+=1;return u<=0?c.apply(this,e):_arity(u,_curryN(o,e,c))}}var curryN=_curry2(function(r,t){return 1===r?_curry1(t):_arity(r,_curryN(r,[],t))});function _curry3(i){return function r(e,n,u){switch(arguments.length){case 0:return r;case 1:return _isPlaceholder(e)?r:_curry2(function(r,t){return i(e,r,t)});case 2:return _isPlaceholder(e)&&_isPlaceholder(n)?r:_isPlaceholder(e)?_curry2(function(r,t){return i(r,n,t)}):_isPlaceholder(n)?_curry2(function(r,t){return i(e,r,t)}):_curry1(function(r){return i(e,n,r)});default:return _isPlaceholder(e)&&_isPlaceholder(n)&&_isPlaceholder(u)?r:_isPlaceholder(e)&&_isPlaceholder(n)?_curry2(function(r,t){return i(r,t,u)}):_isPlaceholder(e)&&_isPlaceholder(u)?_curry2(function(r,t){return i(r,n,t)}):_isPlaceholder(n)&&_isPlaceholder(u)?_curry2(function(r,t){return i(e,r,t)}):_isPlaceholder(e)?_curry1(function(r){return i(r,n,u)}):_isPlaceholder(n)?_curry1(function(r){return i(e,r,u)}):_isPlaceholder(u)?_curry1(function(r){return i(e,n,r)}):i(e,n,u)}}}var _isArray=Array.isArray||function(r){return null!=r&&0<=r.length&&"[object Array]"===Object.prototype.toString.call(r)};function _isTransformer(r){return"function"==typeof r["@@transducer/step"]}function _dispatchable(n,u,i){return function(){if(0===arguments.length)return i();var r=Array.prototype.slice.call(arguments,0),t=r.pop();if(!_isArray(t)){for(var e=0;e<n.length;){if("function"==typeof t[n[e]])return t[n[e]].apply(t,r);e+=1}if(_isTransformer(t))return u.apply(null,r)(t)}return i.apply(this,arguments)}}var _xfBase={init:function(){return this.xf["@@transducer/init"]()},result:function(r){return this.xf["@@transducer/result"](r)}},max=_curry2(function(r,t){return r<t?t:r});function _map(r,t){for(var e=0,n=t.length,u=Array(n);e<n;)u[e]=r(t[e]),e+=1;return u}function _isString(r){return"[object String]"===Object.prototype.toString.call(r)}var _isArrayLike=_curry1(function(r){return!!_isArray(r)||!!r&&"object"==typeof r&&!_isString(r)&&(1===r.nodeType?!!r.length:0===r.length||0<r.length&&r.hasOwnProperty(0)&&r.hasOwnProperty(r.length-1))}),XWrap=function(){function r(r){this.f=r}return r.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},r.prototype["@@transducer/result"]=function(r){return r},r.prototype["@@transducer/step"]=function(r,t){return this.f(r,t)},r}();function _xwrap(r){return new XWrap(r)}var bind=_curry2(function(r,t){return _arity(r.length,function(){return r.apply(t,arguments)})});function _arrayReduce(r,t,e){for(var n=0,u=e.length;n<u;){if((t=r["@@transducer/step"](t,e[n]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n+=1}return r["@@transducer/result"](t)}function _iterableReduce(r,t,e){for(var n=e.next();!n.done;){if((t=r["@@transducer/step"](t,n.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n=e.next()}return r["@@transducer/result"](t)}function _methodReduce(r,t,e,n){return r["@@transducer/result"](e[n](bind(r["@@transducer/step"],r),t))}var symIterator="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function _reduce(r,t,e){if("function"==typeof r&&(r=_xwrap(r)),_isArrayLike(e))return _arrayReduce(r,t,e);if("function"==typeof e["fantasy-land/reduce"])return _methodReduce(r,t,e,"fantasy-land/reduce");if(null!=e[symIterator])return _iterableReduce(r,t,e[symIterator]());if("function"==typeof e.next)return _iterableReduce(r,t,e);if("function"==typeof e.reduce)return _methodReduce(r,t,e,"reduce");throw new TypeError("reduce: list must be array or iterable")}var XMap=function(){function r(r,t){this.xf=t,this.f=r}return r.prototype["@@transducer/init"]=_xfBase.init,r.prototype["@@transducer/result"]=_xfBase.result,r.prototype["@@transducer/step"]=function(r,t){return this.xf["@@transducer/step"](r,this.f(t))},r}(),_xmap=_curry2(function(r,t){return new XMap(r,t)});function _has(r,t){return Object.prototype.hasOwnProperty.call(t,r)}var toString=Object.prototype.toString,_isArguments=function(){return"[object Arguments]"===toString.call(arguments)?function(r){return"[object Arguments]"===toString.call(r)}:function(r){return _has("callee",r)}},hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],hasArgsEnumBug=function(){return arguments.propertyIsEnumerable("length")}(),contains=function(r,t){for(var e=0;e<r.length;){if(r[e]===t)return!0;e+=1}return!1},_keys="function"!=typeof Object.keys||hasArgsEnumBug?function(r){if(Object(r)!==r)return[];var t,e,n=[],u=hasArgsEnumBug&&_isArguments(r);for(t in r)!_has(t,r)||u&&"length"===t||(n[n.length]=t);if(hasEnumBug)for(e=nonEnumerableProps.length-1;0<=e;)_has(t=nonEnumerableProps[e],r)&&!contains(n,t)&&(n[n.length]=t),--e;return n}:function(r){return Object(r)!==r?[]:Object.keys(r)},keys=_curry1(_keys),map=_curry2(_dispatchable(["fantasy-land/map","map"],_xmap,function(e,n){switch(Object.prototype.toString.call(n)){case"[object Function]":return curryN(n.length,function(){return e.call(this,n.apply(this,arguments))});case"[object Object]":return _reduce(function(r,t){return r[t]=e(n[t]),r},{},keys(n));default:return _map(e,n)}})),path=_curry2(function(r,t){for(var e=t,n=0;n<r.length;){if(null==e)return;e=e[r[n]],n+=1}return e}),prop=_curry2(function(r,t){return path([r],t)}),pluck=_curry2(function(r,t){return map(prop(r),t)}),reduce=_curry3(_reduce),ap=_curry2(function(t,e){return"function"==typeof e["fantasy-land/ap"]?e["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(e):"function"==typeof t?function(r){return t(r)(e(r))}:_reduce(function(r,t){return _concat(r,map(t,e))},[],t)}),values=_curry1(function(r){for(var t=keys(r),e=t.length,n=[],u=0;u<e;)n[u]=r[t[u]],u+=1;return n});function _isFunction(r){return"[object Function]"===Object.prototype.toString.call(r)}var liftN=_curry2(function(r,t){var e=curryN(r,t);return curryN(r,function(){return _reduce(ap,map(e,arguments[0]),Array.prototype.slice.call(arguments,1))})}),lift=_curry1(function(r){return liftN(r.length,r)}),curry=_curry1(function(r){return curryN(r.length,r)}),call=curry(function(r){return r.apply(this,Array.prototype.slice.call(arguments,1))});function _makeFlat(c){return function r(t){for(var e,n,u,i=[],o=0,a=t.length;o<a;){if(_isArrayLike(t[o]))for(u=0,n=(e=c?r(t[o]):t[o]).length;u<n;)i[i.length]=e[u],u+=1;else i[i.length]=t[o];o+=1}return i}}function _forceReduced(r){return{"@@transducer/value":r,"@@transducer/reduced":!0}}var preservingReduced=function(e){return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(r){return e["@@transducer/result"](r)},"@@transducer/step":function(r,t){r=e["@@transducer/step"](r,t);return r["@@transducer/reduced"]?_forceReduced(r):r}}},_flatCat=function(r){var e=preservingReduced(r);return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(r){return e["@@transducer/result"](r)},"@@transducer/step":function(r,t){return _isArrayLike(t)?_reduce(e,r,t):_reduce(e,r,[t])}}},_xchain=_curry2(function(r,t){return map(r,_flatCat(t))}),chain=_curry2(_dispatchable(["fantasy-land/chain","chain"],_xchain,function(t,e){return"function"==typeof e?function(r){return t(e(r))(r)}:_makeFlat(!1)(map(t,e))}));function _cloneRegExp(r){return new RegExp(r.source,(r.global?"g":"")+(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.sticky?"y":"")+(r.unicode?"u":""))}var type=_curry1(function(r){return null===r?"Null":void 0===r?"Undefined":Object.prototype.toString.call(r).slice(8,-1)});function _clone(u,i,o,a){function r(r){for(var t,e=i.length,n=0;n<e;){if(u===i[n])return o[n];n+=1}for(t in i[n+1]=u,o[n+1]=r,u)r[t]=a?_clone(u[t],i,o,!0):u[t];return r}switch(type(u)){case"Object":return r({});case"Array":return r([]);case"Date":return new Date(u.valueOf());case"RegExp":return _cloneRegExp(u);default:return u}}var clone=_curry1(function(r){return null!=r&&"function"==typeof r.clone?r.clone():_clone(r,[],[],!0)}),not=_curry1(function(r){return!r}),complement=lift(not);function _pipe(r,t){return function(){return t.call(this,r.apply(this,arguments))}}function _checkForMethod(e,n){return function(){var r,t=arguments.length;return 0===t?n():_isArray(r=arguments[t-1])||"function"!=typeof r[e]?n.apply(this,arguments):r[e].apply(r,Array.prototype.slice.call(arguments,0,t-1))}}var slice=_curry3(_checkForMethod("slice",function(r,t,e){return Array.prototype.slice.call(e,r,t)})),tail=_curry1(_checkForMethod("tail",slice(1,1/0)));function pipe(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return _arity(arguments[0].length,reduce(_pipe,arguments[0],tail(arguments)))}var reverse=_curry1(function(r){return _isString(r)?r.split("").reverse().join(""):Array.prototype.slice.call(r,0).reverse()});function compose(){if(0===arguments.length)throw new Error("compose requires at least one argument");return pipe.apply(this,reverse(arguments))}function _arrayFromIterator(r){for(var t,e=[];!(t=r.next()).done;)e.push(t.value);return e}function _containsWith(r,t,e){for(var n=0,u=e.length;n<u;){if(r(t,e[n]))return!0;n+=1}return!1}function _functionName(r){r=String(r).match(/^function (\w*)/);return null==r?"":r[1]}var identical=_curry2(function(r,t){return r===t?0!==r||1/r==1/t:r!=r&&t!=t});function _uniqContentEquals(r,t,e,n){r=_arrayFromIterator(r);function u(r,t){return _equals(r,t,e.slice(),n.slice())}return!_containsWith(function(r,t){return!_containsWith(u,t,r)},_arrayFromIterator(t),r)}function _equals(r,t,e,n){if(!identical(r,t)){var u=type(r);if(u!==type(t))return!1;if(null==r||null==t)return!1;if("function"==typeof r["fantasy-land/equals"]||"function"==typeof t["fantasy-land/equals"])return"function"==typeof r["fantasy-land/equals"]&&r["fantasy-land/equals"](t)&&"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](r);if("function"==typeof r.equals||"function"==typeof t.equals)return"function"==typeof r.equals&&r.equals(t)&&"function"==typeof t.equals&&t.equals(r);switch(u){case"Arguments":case"Array":case"Object":if("function"==typeof r.constructor&&"Promise"===_functionName(r.constructor))return r===t;break;case"Boolean":case"Number":case"String":if(typeof r==typeof t&&identical(r.valueOf(),t.valueOf()))break;return!1;case"Date":if(identical(r.valueOf(),t.valueOf()))break;return!1;case"Error":return r.name===t.name&&r.message===t.message;case"RegExp":if(r.source!==t.source||r.global!==t.global||r.ignoreCase!==t.ignoreCase||r.multiline!==t.multiline||r.sticky!==t.sticky||r.unicode!==t.unicode)return!1}for(var i=e.length-1;0<=i;){if(e[i]===r)return n[i]===t;--i}switch(u){case"Map":return r.size!==t.size?!1:_uniqContentEquals(r.entries(),t.entries(),e.concat([r]),n.concat([t]));case"Set":return r.size!==t.size?!1:_uniqContentEquals(r.values(),t.values(),e.concat([r]),n.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var o=keys(r);if(o.length!==keys(t).length)return!1;for(var a=e.concat([r]),c=n.concat([t]),i=o.length-1;0<=i;){var l=o[i];if(!_has(l,t)||!_equals(t[l],r[l],a,c))return!1;--i}}return!0}var equals=_curry2(function(r,t){return _equals(r,t,[],[])});function _indexOf(r,t,e){var n,u;if("function"==typeof r.indexOf)switch(typeof t){case"number":if(0===t)for(n=1/t;e<r.length;){if(0===(u=r[e])&&1/u==n)return e;e+=1}else{if(t==t)return r.indexOf(t,e);for(;e<r.length;){if("number"==typeof(u=r[e])&&u!=u)return e;e+=1}}return-1;case"string":case"boolean":case"function":case"undefined":return r.indexOf(t,e);case"object":if(null===t)return r.indexOf(t,e)}for(;e<r.length;){if(equals(r[e],t))return e;e+=1}return-1}function _contains(r,t){return 0<=_indexOf(t,r,0)}function _quote(r){return'"'+r.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var pad=function(r){return(r<10?"0":"")+r},_toISOString="function"==typeof Date.prototype.toISOString?function(r){return r.toISOString()}:function(r){return r.getUTCFullYear()+"-"+pad(r.getUTCMonth()+1)+"-"+pad(r.getUTCDate())+"T"+pad(r.getUTCHours())+":"+pad(r.getUTCMinutes())+":"+pad(r.getUTCSeconds())+"."+(r.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function _complement(r){return function(){return!r.apply(this,arguments)}}function _filter(r,t){for(var e=0,n=t.length,u=[];e<n;)r(t[e])&&(u[u.length]=t[e]),e+=1;return u}function _isObject(r){return"[object Object]"===Object.prototype.toString.call(r)}var XFilter=function(){function r(r,t){this.xf=t,this.f=r}return r.prototype["@@transducer/init"]=_xfBase.init,r.prototype["@@transducer/result"]=_xfBase.result,r.prototype["@@transducer/step"]=function(r,t){return this.f(t)?this.xf["@@transducer/step"](r,t):r},r}(),_xfilter=_curry2(function(r,t){return new XFilter(r,t)}),filter=_curry2(_dispatchable(["filter"],_xfilter,function(e,n){return _isObject(n)?_reduce(function(r,t){return e(n[t])&&(r[t]=n[t]),r},{},keys(n)):_filter(e,n)})),reject=_curry2(function(r,t){return filter(_complement(r),t)});function _toString(e,n){function u(r){var t=n.concat([e]);return _contains(r,t)?"<Circular>":_toString(r,t)}function r(t,r){return _map(function(r){return _quote(r)+": "+u(t[r])},r.slice().sort())}switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+_map(u,e).join(", ")+"))";case"[object Array]":return"["+_map(u,e).concat(r(e,reject(function(r){return/^\d+$/.test(r)},keys(e)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof e?"new Boolean("+u(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?u(NaN):_quote(_toISOString(e)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof e?"new Number("+u(e.valueOf())+")":1/e==-1/0?"-0":e.toString(10);case"[object String]":return"object"==typeof e?"new String("+u(e.valueOf())+")":_quote(e);case"[object Undefined]":return"undefined";default:if("function"==typeof e.toString){var t=e.toString();if("[object Object]"!==t)return t}return"{"+r(e,keys(e)).join(", ")+"}"}}var toString$1=_curry1(function(r){return _toString(r,[])}),converge=_curry2(function(r,n){return curryN(reduce(max,0,pluck("length",n)),function(){var t=arguments,e=this;return r.apply(e,_map(function(r){return r.apply(e,t)},n))})}),XReduceBy=function(){function r(r,t,e,n){this.valueFn=r,this.valueAcc=t,this.keyFn=e,this.xf=n,this.inputs={}}return r.prototype["@@transducer/init"]=_xfBase.init,r.prototype["@@transducer/result"]=function(r){for(var t in this.inputs)if(_has(t,this.inputs)&&(r=this.xf["@@transducer/step"](r,this.inputs[t]))["@@transducer/reduced"]){r=r["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](r)},r.prototype["@@transducer/step"]=function(r,t){var e=this.keyFn(t);return this.inputs[e]=this.inputs[e]||[e,this.valueAcc],this.inputs[e][1]=this.valueFn(this.inputs[e][1],t),r},r}(),_xreduceBy=_curryN(4,[],function(r,t,e,n){return new XReduceBy(r,t,e,n)}),reduceBy=_curryN(4,[],_dispatchable([],_xreduceBy,function(n,u,i,r){return _reduce(function(r,t){var e=i(t);return r[e]=n(_has(e,r)?r[e]:u,t),r},{},r)})),countBy=reduceBy(function(r,t){return r+1},0),dec=add(-1),XDropRepeatsWith=function(){function r(r,t){this.xf=t,this.pred=r,this.lastValue=void 0,this.seenFirstValue=!1}return r.prototype["@@transducer/init"]=_xfBase.init,r.prototype["@@transducer/result"]=_xfBase.result,r.prototype["@@transducer/step"]=function(r,t){var e=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(e=!0):this.seenFirstValue=!0,this.lastValue=t,e?r:this.xf["@@transducer/step"](r,t)},r}(),_xdropRepeatsWith=_curry2(function(r,t){return new XDropRepeatsWith(r,t)}),nth=_curry2(function(r,t){r=r<0?t.length+r:r;return _isString(t)?t.charAt(r):t[r]}),last=nth(-1),dropRepeatsWith=_curry2(_dispatchable([],_xdropRepeatsWith,function(r,t){var e=[],n=1,u=t.length;if(0!==u)for(e[0]=t[0];n<u;)r(last(e),t[n])||(e[e.length]=t[n]),n+=1;return e})),dropRepeats=_curry1(_dispatchable([],_xdropRepeatsWith(equals),dropRepeatsWith(equals))),flip=_curry1(function(n){return curryN(n.length,function(r,t){var e=Array.prototype.slice.call(arguments,0);return e[0]=t,e[1]=r,n.apply(this,e)})}),groupBy=_curry2(_checkForMethod("groupBy",reduceBy(function(r,t){return(r=null==r?[]:r).push(t),r},null))),head=nth(0);function _identity(r){return r}var identity=_curry1(_identity),inc=add(1),indexBy=reduceBy(function(r,t){return t},null),init=slice(0,-1),_Set=function(){function r(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return r.prototype.add=function(r){return!hasOrAdd(r,!0,this)},r.prototype.has=function(r){return hasOrAdd(r,!1,this)},r}();function hasOrAdd(r,t,e){var n,u,i=typeof r;switch(i){case"string":case"number":return 0===r&&1/r==-1/0?!!e._items["-0"]||(t&&(e._items["-0"]=!0),!1):null!==e._nativeSet?t?(n=e._nativeSet.size,e._nativeSet.add(r),e._nativeSet.size===n):e._nativeSet.has(r):i in e._items?r in e._items[i]||(t&&(e._items[i][r]=!0),!1):(t&&(e._items[i]={},e._items[i][r]=!0),!1);case"boolean":return i in e._items?!!e._items[i][u=r?1:0]||(t&&(e._items[i][u]=!0),!1):(t&&(e._items[i]=r?[!1,!0]:[!0,!1]),!1);case"function":return null!==e._nativeSet?t?(n=e._nativeSet.size,e._nativeSet.add(r),e._nativeSet.size===n):e._nativeSet.has(r):i in e._items?!!_contains(r,e._items[i])||(t&&e._items[i].push(r),!1):(t&&(e._items[i]=[r]),!1);case"undefined":return!!e._items[i]||(t&&(e._items[i]=!0),!1);case"object":if(null===r)return!!e._items.null||(t&&(e._items.null=!0),!1);default:return(i=Object.prototype.toString.call(r))in e._items?!!_contains(r,e._items[i])||(t&&e._items[i].push(r),!1):(t&&(e._items[i]=[r]),!1)}}var uniqBy=_curry2(function(r,t){for(var e,n,u=new _Set,i=[],o=0;o<t.length;)e=r(n=t[o]),u.add(e)&&i.push(n),o+=1;return i}),uniq=uniqBy(identity),invoker=_curry2(function(t,e){return curryN(t+1,function(){var r=arguments[t];if(null!=r&&_isFunction(r[e]))return r[e].apply(r,Array.prototype.slice.call(arguments,0,t));throw new TypeError(toString$1(r)+' does not have a method named "'+e+'"')})}),join=invoker(1,"join"),juxt=_curry1(function(r){return converge(function(){return Array.prototype.slice.call(arguments,0)},r)});function _isNumber(r){return"[object Number]"===Object.prototype.toString.call(r)}var sum=reduce(add,0),memoizeWith=_curry2(function(t,e){var n={};return _arity(e.length,function(){var r=t.apply(this,arguments);return _has(r,n)||(n[r]=e.apply(this,arguments)),n[r]})}),memoize=memoizeWith(function(){return toString$1(arguments)}),multiply=_curry2(function(r,t){return r*t});function _createPartialApplicator(e){return _curry2(function(r,t){return _arity(Math.max(0,r.length-t.length),function(){return r.apply(this,e(t,arguments))})})}var partialRight=_createPartialApplicator(flip(_concat)),partition=juxt([filter,reject]),pickAll=_curry2(function(r,t){for(var e={},n=0,u=r.length;n<u;){var i=r[n];e[i]=t[i],n+=1}return e}),product=reduce(multiply,1),useWith=_curry2(function(n,u){return curryN(u.length,function(){for(var r=arguments,t=[],e=0;e<u.length;)t.push(u[e].call(this,r[e])),e+=1;return n.apply(this,t.concat(Array.prototype.slice.call(arguments,u.length)))})}),project=useWith(_map,[pickAll,identity]),range=_curry2(function(r,t){if(!_isNumber(r)||!_isNumber(t))throw new TypeError("Both arguments to range must be numbers");for(var e=[],n=r;n<t;)e.push(n),n+=1;return e}),split=invoker(1,"split"),toLower=invoker(0,"toLowerCase"),toPairs=_curry1(function(r){var t,e=[];for(t in r)_has(t,r)&&(e[e.length]=[t,r[t]]);return e}),toUpper=invoker(0,"toUpperCase"),transduce=curryN(4,function(r,t,e,n){return _reduce(r("function"==typeof t?_xwrap(t):t),e,n)}),ws="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",zeroWidth="​",hasProtoTrim="function"==typeof String.prototype.trim,_trim=hasProtoTrim&&!ws.trim()&&zeroWidth.trim()?function(r){return r.trim()}:function(r){var t=new RegExp("^["+ws+"]["+ws+"]*"),e=new RegExp("["+ws+"]["+ws+"]*$");return r.replace(t,"").replace(e,"")},union=_curry2(compose(uniq,_concat)),unnest=chain(_identity),toString$3=Object.prototype.toString,isPlainObj=function(r){return"[object Object]"===toString$3.call(r)&&(null===(r=Object.getPrototypeOf(r))||r===Object.getPrototypeOf({}))};function doArrayWalk(r,t,e,n){return!!Array.isArray(t)&&!!(e||n&&n.includes(r))}function getPath(n,r){return void 0===n&&(n="array"),{_path:r||("array"===n?[]:""),set:function(r,t){var e;switch(n){case"array":e=this._path.concat([t]);break;case"nestedProperty":e=0===this._path.length?t:Array.isArray(r)?this._path+"["+t+"]":this._path+"."+t;break;default:throw new Error("unrecognized pathType "+n)}return getPath(n,e)},get:function(r,t){return("array"===n?this:this.set(r,t))._path}}}function makeAttrSetterPath(r){var t="",e=0;"_fullData"===r[e]&&(e+=2),"_fullInput"===r[e]&&e++,"_fullLayout"===r[e]&&e++;for(var n=e;n<r.length;n++)"number"==typeof r[n]||Array.isArray(r[n])?t+="["+(Array.isArray(r[n])?r[n][0]:r[n])+"]":t+=(e<n?".":"")+r[n];return t}function _walkObject(e,n,u,i){var o=i.walkArrays,a=i.walkArraysMatchingKeys;Object.keys(e).forEach(function(r){var t;!n(r,e,u.get(e,r))&&(t=e[r],isPlainObj(t)||doArrayWalk(r,t,o,a))&&_walkObject(t,n,u.set(e,r),i)})}function walkObject(r,t,e){if(void 0===e&&(e={}),!isPlainObj(r)&&!Array.isArray(r))throw new Error("The input must be an object.");_walkObject(r,t,getPath(e.pathType),e)}var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(r,t){return r(t={exports:{}},t.exports),t.exports}var crossfilter$2=createCommonjsModule(function(r,t){function U(r){return r}function k(r,t){for(var e=0,n=t.length,u=new Array(n);e<n;++e)u[e]=r[t[e]];return u}function e(i){function r(r,t,e,n){for(;e<n;){var u=e+n>>>1;t<i(r[u])?n=u:e=1+u}return e}return(r.right=r).left=function(r,t,e,n){for(;e<n;){var u=e+n>>>1;i(r[u])<t?e=1+u:n=u}return e},r}function z(a){function r(r,t,e){for(var n=e-t,u=1+(n>>>1);0<--u;)i(r,u,n,t);return r}function i(r,t,e,n){for(var u,i=r[--n+t],o=a(i);(u=t<<1)<=e&&(u<e&&a(r[n+u])>a(r[n+u+1])&&u++,!(o<=a(r[n+u])));)r[n+t]=r[n+u],t=u;r[n+t]=i}return r.sort=function(r,t,e){for(var n,u=e-t;0<--u;)n=r[t],r[t]=r[t+u],r[t+u]=n,i(r,1,u,t);return r},r}function X(c){var l=z(c);return function(r,t,e,n){for(var u,i,o=new Array(n=Math.min(e-t,n)),a=0;a<n;++a)o[a]=r[t++];if(l(o,0,n),t<e)for(u=c(o[0]);c(i=r[t])>u&&(o[0]=i,u=c(l(o,0,n)[0])),++t<e;);return o}}function i(a){return function(r,t,e){for(var n=t+1;n<e;++n){for(var u=n,i=r[n],o=a(i);t<u&&a(r[u-1])>o;--u)r[u]=r[u-1];r[u]=i}return r}}function D(E){var n=i(E);function j(r,t,e){return(e-t<o?n:u)(r,t,e)}function u(r,t,e){var n,u=(e-t)/6|0,i=t+u,o=e-1-u,a=t+e-1>>1,c=a-u,u=a+u,l=r[i],s=E(l),f=r[c],p=E(f),d=r[a],y=E(d),h=r[u],_=E(h),g=r[o],m=E(g),s=(p<s&&(x=l,l=f,f=x,x=s,s=p,p=x),m<_&&(x=h,h=g,g=x,x=_,_=m,m=x),y<s&&(x=l,l=d,d=x,x=s,s=y,y=x),y<p&&(x=f,f=d,d=x,x=p,p=y,y=x),_<s&&(x=l,l=h,h=x,x=s,s=_,_=x),_<y&&(x=d,d=h,h=x,x=y,y=_,_=x),m<p&&(x=f,f=g,g=x,x=p,p=m,m=x),y<p&&(x=f,f=d,d=x,x=p,p=y,y=x),m<_&&(x=h,h=g,g=x,x=_,_=m,m=x),f),v=p,y=h,b=_,A=(r[i]=l,r[c]=r[t],r[a]=d,r[u]=r[e-1],r[o]=g,t+1),S=e-2,x=v<=b&&b<=v;if(x)for(var w=A;w<=S;++w){var O=r[w];if((k=E(O))<v)w!==A&&(r[w]=r[A],r[A]=O),++A;else if(v<k)for(;;){if(!(v<(D=E(r[S])))){if(D<v){r[w]=r[A],r[A++]=r[S],r[S--]=O;break}r[w]=r[S],r[S--]=O;break}S--}}else for(w=A;w<=S;w++){O=r[w];if((k=E(O))<v)w!==A&&(r[w]=r[A],r[A]=O),++A;else if(b<k)for(;;){if(!(b<(D=E(r[S])))){D<v?(r[w]=r[A],r[A++]=r[S]):r[w]=r[S],r[S--]=O;break}if(--S<w)break}}if(r[t]=r[A-1],r[A-1]=s,r[e-1]=r[S+1],r[S+1]=y,j(r,t,A-1),j(r,S+2,e),x)return r;if(A<i&&o<S){for(;(n=E(r[A]))<=v&&v<=n;)++A;for(;(D=E(r[S]))<=b&&b<=D;)--S;for(w=A;w<=S;w++){var k,D,O=r[w];if((k=E(O))<=v&&v<=k)w!==A&&(r[w]=r[A],r[A]=O),A++;else if(k<=b&&b<=k)for(;;){if(!((D=E(r[S]))<=b&&b<=D)){D<v?(r[w]=r[A],r[A++]=r[S]):r[w]=r[S],r[S--]=O;break}if(--S<w)break}}}return j(r,A,S+1)}return j}function n(r){for(var t=new Array(r),e=-1;++e<r;)t[e]=0;return t}function E(r){return[0,r.length]}function H(){return null}function $(){return 0}function V(r){return r+1}function G(r){return r-1}function K(e){return function(r,t){return r+ +e(t)}}function Y(e){return function(r,t){return r-e(t)}}function u(){var r={add:t,remove:function(){for(var t=Z(R,R),e=[],r=0,n=0;r<R;++r)M[r]?t[r]=n++:e.push(r);L.forEach(function(r){r(0,[],e)}),W.forEach(function(r){r(t)});for(var u,r=0,n=0;r<R;++r)(u=M[r])&&(r!==n&&(M[n]=u,q[n]=q[r]),++n);q.length=n;for(;n<R;)M[--R]=0},dimension:function(s){var f,p,d,y,h,c={filter:function(r){return null==r?a():(Array.isArray(r)?o:"function"==typeof r?l:u)(r)},filterExact:u,filterRange:o,filterFunction:l,filterAll:a,top:function(r){var t,e=[],n=b;for(;--n>=v&&0<r;)M[t=p[n]]||(e.push(q[t]),--r);return e},bottom:function(r){var t,e=[],n=v;for(;n<b&&0<r;)M[t=p[n]]||(e.push(q[t]),--r),n++;return e},group:S,groupAll:function(){var r=S(H),t=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return t()[0].value},r},dispose:r,remove:r},_=~x&-~x,T=~_,g=D(function(r){return d[r]}),m=E,B=[],I=[],v=0,b=0;O.unshift(t),O.push(e),W.push(n),x|=_,(32<=w?!_:x&-(1<<w))&&(M=rr(M,w<<=1));function t(r,t,e){d=r.map(s),y=g(function(r){for(var t=Z(r,r),e=-1;++e<r;)t[e]=e;return t}(e),0,e),d=k(d,y);var n,r=m(d),u=r[0],i=r[1];if(h)for(n=0;n<e;++n)h(d[n],n)||(M[y[n]+t]|=_);else{for(n=0;n<u;++n)M[y[n]+t]|=_;for(n=i;n<e;++n)M[y[n]+t]|=_}if(t){var o=f,a=p,c=0,l=0;for(f=new Array(R),p=Z(R,R),n=0;c<t&&l<e;++n)o[c]<d[l]?(f[n]=o[c],p[n]=a[c++]):(f[n]=d[l],p[n]=y[l++]+t);for(;c<t;++c,++n)f[n]=o[c],p[n]=a[c];for(;l<e;++l,++n)f[n]=d[l],p[n]=y[l]+t;r=m(f),v=r[0],b=r[1]}else f=d,p=y,v=u,b=i}function e(r,t,e){B.forEach(function(r){r(d,y,t,e)}),d=y=null}function n(r){for(var t,e=0,n=0;e<R;++e)M[t=p[e]]&&(e!==n&&(f[n]=f[e]),p[n]=r[t],++n);for(f.length=n;n<R;)p[n++]=0;var u=m(f);v=u[0],b=u[1]}function i(r){var e=r[0],n=r[1];if(h)h=null,A(function(r,t){return e<=t&&t<n}),v=e,b=n;else{var t,u,i,o=[],a=[];if(e<v)for(t=e,u=Math.min(v,n);t<u;++t)M[i=p[t]]^=_,o.push(i);else if(v<e)for(t=v,u=Math.min(e,b);t<u;++t)M[i=p[t]]^=_,a.push(i);if(b<n)for(t=Math.max(e,b),u=n;t<u;++t)M[i=p[t]]^=_,o.push(i);else if(n<b)for(t=Math.max(v,n),u=b;t<u;++t)M[i=p[t]]^=_,a.push(i);v=e,b=n,L.forEach(function(r){r(_,o,a)})}return c}function u(r){return i((e=j,n=r,(m=function(r){var t=r.length;return[e.left(r,n,0,t),e.right(r,n,0,t)]})(f)));var e,n}function o(r){return i((e=j,n=r[0],u=r[1],(m=function(r){var t=r.length;return[e.left(r,n,0,t),e.left(r,u,0,t)]})(f)));var e,n,u}function a(){return i((m=E)(f))}function l(r){return m=E,A(h=r),v=0,b=R,c}function A(r){for(var t,e,n=[],u=[],i=0;i<R;++i)!(M[t=p[i]]&_)^!!(e=r(f[i],i))&&(e?(M[t]&=T,n):(M[t]|=_,u)).push(t);L.forEach(function(r){r(_,n,u)})}function S(m){var n={top:function(r){r=e(o(),0,v.length,r);return u.sort(r,0,r.length)},all:o,reduce:c,reduceCount:r,reduceSum:function(r){return c(K(r),Y(r),$)},order:l,orderNatural:function(){return l(U)},size:function(){return O},dispose:s,remove:s};I.push(n);var v,b,e,u,A,a,S,x=8,w=J(x),O=0,k=H,D=H,E=!0,j=m===H;function t(r,t,e,n){var u,i,o,a,c,l,s=v,f=Z(O,w),p=A,d=S,y=O,h=0,_=0;for(E&&(p=d=H),v=new Array(O),O=0,b=1<y?Q(b,R):Z(R,w),y&&(o=(i=s[0]).key);_<n&&!((a=m(r[_]))>=a);)++_;for(;_<n;){for(i&&o<=a?(c=i,l=o,f[h]=O,(i=s[++h])&&(o=i.key)):(c={key:a,value:d()},l=a),v[O]=c;!(l<a||(b[u=t[_]+e]=O,M[u]&T||(c.value=p(c.value,q[u])),++_>=n));)a=m(r[_]);g()}for(;h<y;)v[f[h]=O]=s[h++],g();if(h<O)for(h=0;h<e;++h)b[h]=f[b[h]];function g(){++O===w&&(f=rr(f,x<<=1),b=rr(b,x),w=J(x))}u=L.indexOf(k),1<O?(k=P,D=C):(!O&&j&&(O=1,v=[{key:null,value:d()}]),D=1===O?(k=N,F):k=H,b=null),L[u]=k}function i(){if(1<O){for(var r=O,t=v,e=Z(r,r),n=0,u=0;n<R;++n)M[n]&&(e[b[u]=b[n]]=1,++u);for(v=[],n=O=0;n<r;++n)e[n]&&(e[n]=O++,v.push(t[n]));if(1<O)for(n=0;n<u;++n)b[n]=e[b[n]];else b=null;L[L.indexOf(k)]=1<O?(D=C,k=P):1===O?(D=F,k=N):D=k=H}else if(1===O&&!j){for(n=0;n<R;++n)if(M[n])return;v=[],O=0,L[L.indexOf(k)]=k=D=H}}function P(r,t,e){if(r!==_&&!E){for(var n,u,i=0,o=t.length;i<o;++i)M[n=t[i]]&T||((u=v[b[n]]).value=A(u.value,q[n]));for(i=0,o=e.length;i<o;++i)(M[n=e[i]]&T)===r&&((u=v[b[n]]).value=a(u.value,q[n]))}}function N(r,t,e){if(r!==_&&!E){for(var n,u=v[0],i=0,o=t.length;i<o;++i)M[n=t[i]]&T||(u.value=A(u.value,q[n]));for(i=0,o=e.length;i<o;++i)(M[n=e[i]]&T)===r&&(u.value=a(u.value,q[n]))}}function C(){for(var r,t=0;t<O;++t)v[t].value=S();for(t=0;t<R;++t)M[t]&T||((r=v[b[t]]).value=A(r.value,q[t]))}function F(){var r,t=v[0];for(t.value=S(),r=0;r<R;++r)M[r]&T||(t.value=A(t.value,q[r]))}function o(){return E&&(D(),E=!1),v}function c(r,t,e){return A=r,a=t,S=e,E=!0,n}function r(){return c(V,G,$)}function l(t){function r(r){return t(r.value)}return e=X(r),u=z(r),n}function s(){var r=L.indexOf(k);return 0<=r&&L.splice(r,1),0<=(r=B.indexOf(t))&&B.splice(r,1),0<=(r=W.indexOf(i))&&W.splice(r,1),n}return arguments.length<1&&(m=U),L.push(k),B.push(t),W.push(i),t(f,p,0,R),r().orderNatural()}function r(){I.forEach(function(r){r.dispose()});var r=O.indexOf(t);return 0<=r&&O.splice(r,1),0<=(r=O.indexOf(e))&&O.splice(r,1),0<=(r=W.indexOf(n))&&W.splice(r,1),x&=T,a()}return t(q,0,R),e(0,0,R),c},groupAll:function(){var o,a,c,n,u={reduce:i,reduceCount:r,reduceSum:function(r){return i(K(r),Y(r),$)},value:function(){l&&(function(){var r;for(o=n(),r=0;r<R;++r)M[r]||(o=a(o,q[r]))}(),l=!1);return o},dispose:s,remove:s},l=!0;function t(r,t){var e;if(!l)for(e=t;e<R;++e)M[e]||(o=a(o,q[e]))}function e(r,t,e){var n,u,i;if(!l){for(n=0,i=t.length;n<i;++n)M[u=t[n]]||(o=a(o,q[u]));for(n=0,i=e.length;n<i;++n)M[u=e[n]]===r&&(o=c(o,q[u]))}}function i(r,t,e){return a=r,c=t,n=e,l=!0,u}function r(){return i(V,G,$)}function s(){var r=L.indexOf(e);return 0<=r&&L.splice(r),0<=(r=O.indexOf(t))&&O.splice(r),u}return L.push(e),O.push(t),t(0,0),r()},size:function(){return R}},q=[],R=0,x=0,w=8,M=a(0),L=[],O=[],W=[];function t(t){var e=R,n=t.length;return n&&(q=q.concat(t),M=Q(M,R+=n),O.forEach(function(r){r(t,e,n)})),r}return arguments.length?t(arguments[0]):r}function Z(r,t){return(t<257?a:t<65537?c:l)(r)}function J(r){return 8===r?256:16===r?65536:4294967296}var j,o,a,c,l,Q,rr;t=t||commonjsGlobal,u.version="1.3.12",u.permute=k,(j=u.bisect=e(U)).by=e,(u.heap=z(U)).by=z,(u.heapselect=X(U)).by=X,(u.insertionsort=i(U)).by=i,(u.quicksort=D(U)).by=D,o=32,l=c=a=n,Q=function(r,t){var e=r.length;for(;e<t;)r[e++]=0;return r},rr=function(r,t){if(32<t)throw new Error("invalid array width!");return r},"undefined"!=typeof Uint8Array&&(a=function(r){return new Uint8Array(r)},c=function(r){return new Uint16Array(r)},l=function(r){return new Uint32Array(r)},Q=function(r,t){return r.length>=t?r:((t=new r.constructor(t)).set(r),t)},rr=function(r,t){var e;switch(t){case 16:e=c(r.length);break;case 32:e=l(r.length);break;default:throw new Error("invalid array width!")}return e.set(r),e}),t.crossfilter=u}),crossfilter=crossfilter$2.crossfilter,isStringBlank=function(r){for(var t,e=r.length,n=0;n<e;n++)if(((t=r.charCodeAt(n))<9||13<t)&&32!==t&&133!==t&&160!==t&&5760!==t&&6158!==t&&(t<8192||8205<t)&&8232!==t&&8233!==t&&8239!==t&&8287!==t&&8288!==t&&12288!==t&&65279!==t)return!1;return!0},fastIsnumeric=function(r){var t=typeof r;if("string"==t){var e=r;if(0===(r=+r)&&isStringBlank(e))return!1}else if("number"!=t)return!1;return r-r<1},cf=crossfilter,CROSSFILTER_WHITELISTED_PLOTS=["bar","box","choropleth","histogram","pie","scatter","scatter3d","scattergeo","scattermapbox","table"],DESELECTDIM=.1,DESELECTDIM_MAPBOX=.01,srcFieldSuffix="src",keepColumnId=/[^:]+(?=[^:]*$)/,gridSourceAttribute=function(r){return"src"===r.slice(-srcFieldSuffix.length)},getBaseAttributeName=function(r){return r.slice(0,-srcFieldSuffix.length)},getPlotArray=function(r){return[].slice.call(r.querySelectorAll(".js-plotly-plot"))},collectFieldSourcesInTrace=function(c,l,s){return walkObject(l,function(r,n,u){var t,i,o,a,e=c._crossfilter;"table"===l.type&&"header"===u[0]||gridSourceAttribute(r)&&(t=n[r].match(keepColumnId)[0],o=getBaseAttributeName(i=r),a=[],"table"===l.type&&"cells"===u[0]?t.replace(/\*/g,"").split(",").forEach(function(r,t){var e=u.concat([o,t]);a.push({gd:c,srcFieldName:i,traceIndex:s,data:n[o][t],pathArray:e,fieldPath:makeAttrSetterPath(e),constrained:!1,gridColumnName:r})}):a.push({gd:c,srcFieldName:i,traceIndex:s,data:n[o],pathArray:u.concat([o]),fieldPath:makeAttrSetterPath(u.concat([o])),constrained:!1,gridColumnName:t}),a.forEach(function(r){e.fieldSources[r.gridColumnName]=(e.fieldSources[r.gridColumnName]||[]).concat(r)}))},{walkArraysMatchingKeys:["transforms"]})},eventPointsToDataPoints=function(r,t){for(var e={},n=0;n<t.length;n++){var u=t[n],i=u.fullData&&u.fullData.transforms,i=i?i.filter(function(r){return r._indexToPoints}):[];if(i.length)i[i.length-1]._indexToPoints[u.pointNumber].forEach(function(r){e[r]={pointNumber:r}});else if("pie"===r._fullData[0].type)for(var o=0;o<r.data[0].labels.length;o++)r.data[0].labels[o]===u.label&&(e[o]={pointNumber:o});else e[u.pointNumber]=u}return e},isDashboardCompliantForCrossfilter=function(r){var t=r.every(function(r){return-1!==CROSSFILTER_WHITELISTED_PLOTS.indexOf(r.type)}),e={},n=(r.forEach(function(t){return Object.keys(t).filter(gridSourceAttribute).forEach(function(r){r=t[getBaseAttributeName(r)].length;e[r]=!0})}),Object.keys(e).length<2),u=!1;return r.some(function(r){return walkObject(r,function(r){gridSourceAttribute(r)&&(u=!0)},{walkArraysMatchingKeys:["transforms"]})}),t&&u&&n},setDeepProp=function(r,t,e){for(var n=0,u=r;n<t.length;n++){var i=t[n],o=void 0!==u[i];n===t.length-1?u[i]=e:o||(u[i]={}),u=u[i]}},gridBackedAttribute=function(r){return"src"===r.slice(-srcFieldSuffix.length)},eraseGridPropsFromTrace=function(r){return walkObject(r,function(r,t,e){gridBackedAttribute(r)&&"header"!==e[0]&&(t[getBaseAttributeName(r)]=[])},{walkArraysMatchingKeys:["transforms"]})},cfEnabled=function(r,t){return r&&isDashboardCompliantForCrossfilter(t.data)},cfLayoutOverrides={dragmode:"select",showlegend:!1},getCrossfilter=function(r){return r.length?r[0]._crossfilter:{fieldSources:{},cf:null,grid:{}}},persistCrossfilter=function(r,t){r._crossfilter=t},restylePlots=function(e,t,r){var n=t.plotDimensions.concat(t.formDimensions).some(function(r){return r.constrained}),o=n?t.recordDimension.top(1/0).sort(function(r,t){return r.index-t.index}):[];r.filter(function(r){return r.includedInCrossfilter}).forEach(function(i){var r=i._cfData.originalData.map(clone);r.forEach(eraseGridPropsFromTrace),[].concat.apply([],values(t.fieldSources)).filter(function(r){return r.gd===i}).forEach(function(n){var u=o.map(function(r){return r[n.gridColumnName]});r.forEach(function(r,t){var e;t===n.traceIndex&&(setDeepProp(r,n.pathArray,u),e=i._fullData[t].marker||{},e=!Array.isArray(e.color)||!fastIsnumeric(e.color[0]),"pie"!==r.type)&&i._fullData[t].marker&&e&&(r.marker=r.marker||{},r.marker.color=i._fullData[t].marker.color)})}),e.deleteTraces(i,range(i._cfData.originalData.length,i.data.length)),n&&i._fullData.length===i._cfData.originalData.length&&e.addTraces(i,r),r.forEach(function(r,t){return dimTracePostStyle(e,i,n,r,t)})})},resetAllFilters=function(r){return r.plotDimensions.concat(r.formDimensions).forEach(function(r){r.constrained=!1,r.cfDimension&&r.cfDimension.filter(null)})},resetCrossfilter=function(r){var t=getPlotArray(document),e=t[0]._crossfilter;resetAllFilters(e),restylePlots(r,e,[].concat(t).filter(function(r){return r.includedInCrossfilter}))},specFilter=function(r,t){var e=getPlotArray(document),n=t.gridColumn,u=t.isNaN?t.value:Number(t.value),t=t.operator,i=e[0]._crossfilter,o=i.formDimensions[0],a=(o.constrained=!0,o.cfDimension&&(o.cfDimension.filter(null),o.cfDimension.dispose(),o.cfDimension=null,o.constrained=!1),o.cfDimension=i.cf.dimension(function(r){return r[n]}),{">":function(r){return u<r},"<":function(r){return r<u},"==":function(r){return r===u}});o.cfDimension.filterFunction(a[t]),o.constrained=!0,restylePlots(r,i,[].concat(e).filter(function(r){return r.includedInCrossfilter}))},selectionHandler=function(r,t,e){var n=t._crossfilter,u=n.plotDimensions.find(function(r){return r.gd===t}),e=getEventPoints(t,u,e),i=(resetAllFilters(n),eventPointsToDataPoints(t,e));u.constrained=0<e.length,u.constrained||t.querySelectorAll(".select-outline").forEach(function(r){return r.parentNode.removeChild(r)}),u.cfDimension.filterFunction(u.constrained?function(r){return i[r]}:function(){return!0}),r.restyle(t,"selectedpoints",null),restylePlots(r,n,getPlotArray(document).filter(function(r){return r.includedInCrossfilter}))},cfPlotSetup=function(t,r,e,n,u){var i=getCrossfilter(r),o=(persistCrossfilter(n,i),u.data.forEach(function(r,t){return collectFieldSourcesInTrace(n,r,t)}),Object.keys(i.fieldSources).forEach(function(r){var t=i.fieldSources[r];i.grid[r]=t[0].data}),i.cf=cf(),e.then(function(r){"pie"===r._fullData[0].type?r.on("plotly_click",selectionHandler.bind(0,t,r)):r.on("plotly_selected",selectionHandler.bind(0,t,r)),r.includedInCrossfilter=!0,i.plotDimensions&&i.plotDimensions.length&&i.plotDimensions.forEach(function(r){return r.cfDimension.dispose()}),i.plotDimensions=getPlotArray(document).filter(function(r){return r.includedInCrossfilter}).map(function(r){return{gd:r,constrained:!1,cfDimension:i.cf.dimension(function(r){return r.index})}}),i.formDimensions=[{gd:void 0,constrained:!1,cfDimension:null}],n._cfData={originalData:n.data.map(clone),originalFullData:n._fullData.map(clone),originalOpacity:map(function(r){return r.style.opacity})(n.querySelectorAll(".trace"))}}),i.recordDimension=i.cf.dimension(function(r){return r}),toPairs(i.grid));o.length&&(r=o[0][1].map(function(r,t){for(var e={},n=0;n<o.length;n++)e.index=t,e[o[n][0]]=o[n][1][t];return e}),i.cf.add(r))};function getEventPoints(e,r,t){var n=r.constrained&&"pie"===e._fullData[0].type?null:t;return"pie"===e._fullData[0].type?n?n.points:[]:("histogram"===e._fullData[0].type&&(n={points:[]},t)&&!Array.isArray(t)&&t.points.forEach(function(t){(t.pointNumbers||e.calcdata[0][t.pointNumber].pts).forEach(function(r){n.points.push({pointNumber:r,curveNumber:t.curveNumber,data:t.data,fullData:t.fullData})})}),n?n.points.filter(function(r){return r.curveNumber<e._cfData.originalData.length&&r.data.uid===e.data[r.curveNumber].uid}):[])}function toggleContextHover(r,t,e,n){n=n?"none":t._cfData.originalFullData[e].hoverinfo;n&&t._fullData[e].hoverinfo!==n&&-1===["scattermapbox","scattergeo","scatter3d"].indexOf(t._fullData[0].type)&&r.restyle(t,"hoverinfo",n,[e])}function dimTracePostStyle(r,t,e,n,u){var i=r.d3.select(t);switch(n.type){case"choropleth":toggleContextHover(r,t,u,e);var o=t._cfData.originalOpacity[u];return i.selectAll(".trace path").style("opacity",1),i.selectAll(".trace").filter(function(r,t){return t===u}).style("opacity",e?0:o),i.selectAll(".colorbar .cbaxis").style("opacity",0),void window.setTimeout(function(){i.selectAll(".colorbar .cbaxis").style("opacity",function(r,t){return t===u&&e?0:null})});case"scatter":case"box":toggleContextHover(r,t,u,e);var o=t._cfData.originalOpacity[u];return void i.selectAll(".trace").filter(function(r,t){return t===u}).style("opacity",e?DESELECTDIM:o);case"bar":return toggleContextHover(r,t,u,e),void("stack"===t.layout.barmode?r.restyle(t,"visible",!e,range(0,t._cfData.originalData.length)):(o=t._cfData.originalOpacity[u],i.selectAll(".trace").filter(function(r,t){return t===u}).style("opacity",e?DESELECTDIM:o)));case"histogram":o=t._cfData.originalOpacity[u];return void i.selectAll(".trace").filter(function(r,t){return t===u}).style("opacity",e?0:o);case"table":return void i.select(".table").style("opacity",e?0:null);case"pie":return i.select(".trace").style("opacity",e?0:null),void i.selectAll(".hovertext").remove();case"scattermapbox":return void r.restyle(t,"marker.opacity",e?DESELECTDIM_MAPBOX:1,[u]);case"scatter3d":return void r.restyle(t,"marker.opacity",e?DESELECTDIM:t._cfData.originalFullData[u].marker.opacity,[u]);default:r.d3.select(t).select(".trace").style("opacity",e?DESELECTDIM:null)}}exports.cfEnabled=cfEnabled,exports.cfLayoutOverrides=cfLayoutOverrides,exports.resetCrossfilter=resetCrossfilter,exports.specFilter=specFilter,exports.cfPlotSetup=cfPlotSetup;
